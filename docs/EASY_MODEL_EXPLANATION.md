# 小学生でもわかる！インフルエンザ予測研究の解説

**難しい言葉を使わずに、やさしく説明します**

---

## 📖 この研究は何をしたの？

**一言で言うと**:
「北海道のインフルエンザ患者数を、コンピューターで予測する方法を考えました」

**もっと詳しく言うと**:
COVID-19（コロナ）が流行してから、インフルエンザの患者さんが急に減りました。
「なぜ減ったのか？」「どうやって予測できるのか？」を調べました。

---

## 🎯 目次

### 基本編
1. [そもそも「予測」って何？](#1-そもそも予測って何)
2. [なぜインフルエンザは冬に流行るの？](#2-なぜインフルエンザは冬に流行るの)
3. [時系列データって何？](#3-時系列データって何)

### Phase A: コンピューターで予測
4. [特徴量エンジニアリングって何？](#4-特徴量エンジニアリングって何)
5. [XGBoostって何？なぜ強いの？](#5-xgboostって何なぜ強いの)
6. [TimeSeriesSplitって何？](#6-timeseriesplitって何)

### Phase B-E: 「なぜ？」を調べる
7. [Phase Bの失敗：循環参照問題](#7-phase-bの失敗循環参照問題)
8. [Phase C-D: Google検索で恐怖を測る](#8-phase-c-d-google検索で恐怖を測る)

### Phase D拡張版: 大発見！
9. [媒介分析って何？](#9-媒介分析って何)
10. [なぜ会食が重要なの？](#10-なぜ会食が重要なの)
11. [完全媒介って何？](#11-完全媒介って何)

---

## 1. そもそも「予測」って何？

### たとえ話: 明日の天気を当てる

**天気予報士さんの仕事**:
```
過去のデータ:
- 今日は曇り → 明日は雨（確率80%）
- 今日は快晴 → 明日も晴れ（確率70%）
- 今日の湿度が高い → 明日は雨（確率60%）

これらのパターンを覚えて、明日の天気を予測する
```

**この研究も同じ**:
```
過去のデータ:
- 先週100人風邪 → 今週120人風邪（増える！）
- 去年の冬は多かった → 今年の冬も多いかも
- 気温が低い → 風邪が増える

これらのパターンをコンピューターに覚えさせて、来週の患者数を予測
```

### 予測の2種類

#### (1) 「いつ？いくつ？」を当てる（予測モデル）

**質問**: 「来週のインフルエンザ患者数は何人？」
**答え**: 「150人くらいです」

**たとえ**: テストで何点取れるか予想する

#### (2) 「なぜ？」を理解する（因果推論）

**質問**: 「なぜインフルエンザが減ったの？」
**答え**: 「みんなが会食を控えたからです」

**たとえ**: 「なぜテストで良い点が取れたのか？」→「毎日勉強したから」

---

## 2. なぜインフルエンザは冬に流行るの？

### 理由1: ウイルスが冬に強い

**ウイルスの特徴**:
- **寒い**（5℃）: ウイルスが1日以上生きる
- **暖かい**（30℃）: 数時間で死ぬ

**たとえ**: アイスクリームは冬の方が長持ち、夏はすぐ溶ける

### 理由2: 人が室内に集まる

**冬の生活**:
```
寒い → 外に出たくない
     → 家や会社の中にいる
     → 人が密集
     → ウイルスが広がりやすい
```

**夏の生活**:
```
暑い → 外で遊ぶ
     → 窓を開ける
     → 人が密集しない
     → ウイルスが広がりにくい
```

### 理由3: 空気が乾燥

**乾燥するとどうなる？**:
- ウイルスが空気中に長く漂う
- のどや鼻の防御機能が弱くなる

**たとえ**: 濡れたタオルは早く乾く（冬）、なかなか乾かない（梅雨）

---

## 3. 時系列データって何？

### 3.1 普通のデータと何が違う？

#### 普通のデータ（バラバラでOK）

**例: クラスのみんなの身長**
```
太郎くん: 140cm
花子さん: 135cm
次郎くん: 138cm
```

**特徴**: 順番は関係ない（太郎くんを最初に測っても、最後に測っても同じ）

#### 時系列データ（順番が大事）

**例: 太郎くんの身長の変化**
```
1年生: 120cm
2年生: 125cm
3年生: 130cm
4年生: 135cm
5年生: 140cm
```

**特徴**: 順番が超大事！（去年の身長を知ると、今年の身長が予測しやすい）

### 3.2 時系列データの3つの特徴

#### (1) 自己相関（じこそうかん）

**かんたんに言うと**: 「昨日と今日は似ている」

**例1: インフルエンザ**
```
先週100人 → 今週もだいたい100人くらい
（いきなり1000人にはならない）
```

**例2: 太郎くんの身長**
```
去年140cm → 今年もだいたい140cm前後
（いきなり2mにはならない）
```

**数字で表すと**:
- r = 0.89 → めっちゃ似てる（89%同じ）
- r = 0.5 → まあまあ似てる（50%同じ）
- r = 0 → 全然似てない（0%同じ）

#### (2) トレンド（長期的な変化）

**かんたんに言うと**: 「だんだん増える」または「だんだん減る」

**例1: 太郎くんの身長**
```
1年生: 120cm
2年生: 125cm ↑（増えてる）
3年生: 130cm ↑（増えてる）
4年生: 135cm ↑（増えてる）
5年生: 140cm ↑（増えてる）

→ トレンド: 毎年5cmずつ増える
```

**例2: インフルエンザ（COVID-19前後）**
```
2019年冬: 60人
2020年冬: 5人 ↓（激減！）
2021年冬: 3人 ↓（まだ少ない）

→ トレンド: COVID-19以降、ずっと少ない
```

#### (3) 季節性（きせつせい）

**かんたんに言うと**: 「毎年同じ時期に同じパターン」

**例1: アイスクリームの売上**
```
春: 100個
夏: 500個 ↑（増える！）
秋: 150個 ↓（減る）
冬: 50個 ↓（もっと減る）

次の年も同じパターン
春: 100個
夏: 500個 ↑
秋: 150個 ↓
冬: 50個 ↓
```

**例2: インフルエンザ**
```
春（3-5月）: 少ない
夏（6-8月）: すごく少ない
秋（9-11月）: だんだん増える
冬（12-2月）: めっちゃ多い ← ピーク！

毎年このパターンが繰り返される
```

---

## 4. 特徴量エンジニアリングって何？

### 4.1 特徴量（とくちょうりょう）って何？

**かんたんに言うと**: 「予測のヒントになる情報」

**たとえ: テストの点数を予測する**

**ヒントになる情報（特徴量）**:
1. 昨日の勉強時間（多い → 点数高そう）
2. 前回のテストの点数（前回90点 → 今回も高そう）
3. 睡眠時間（よく寝た → 集中できそう）
4. 朝ごはん食べた？（食べた → 頭が働きそう）

**ヒントにならない情報**:
1. 今日の服の色（関係ない）
2. 髪の長さ（関係ない）

### 4.2 特徴量エンジニアリング = ヒント作り

**インフルエンザ予測のヒント作り**:

#### ヒント1: ラグ特徴量（先週のデータ）

```python
df['lag_1'] = df['cases'].shift(1)  # 1週前の患者数
```

**日常の例**:
```
「先週クラスで5人風邪ひいてた → 今週も増えそう」
```

**なぜ役立つ？**:
- インフルエンザはうつる病気
- 先週の患者 → 今週にうつす → 今週も患者が出る
- **先週を知ると、今週が予測しやすい**

#### ヒント2: 季節の情報

```python
df['month'] = df['date'].dt.month  # 何月？
df['is_winter'] = df['month'].isin([12, 1, 2])  # 冬かどうか
```

**日常の例**:
```
「今12月だ → インフルエンザ増えそう」
「今7月だ → インフルエンザ少なそう」
```

#### ヒント3: 気温・湿度

```python
df['temp_avg'] = df_weather['temp'].mean()  # 平均気温
```

**日常の例**:
```
「今日すごく寒い（5℃） → インフルエンザ増えそう」
「今日暖かい（25℃） → インフルエンザ少なそう」
```

### 4.3 どのヒントが一番役立つ？

**実験結果**:

| ヒント | 役立ち度 | たとえ |
|---|---|---|
| **先週の患者数** | ⭐⭐⭐⭐⭐（42%） | 「昨日勉強した内容が今日のテストに出る」 |
| 去年の同じ週 | ⭐⭐⭐（23%） | 「去年の夏休みの宿題が今年も出る」 |
| 何月か | ⭐⭐（15%） | 「12月はクリスマスがある」 |
| 気温 | ⭐（8%） | 「寒いと風邪ひきやすい」 |

**結論**: **先週のデータが一番役立つ！**

---

## 5. XGBoostって何？なぜ強いの？

### 5.1 XGBoostとは？

**正式名称**: eXtreme Gradient Boosting（エクストリーム・グラディエント・ブースティング）

**かんたんに言うと**: 「賢い友達を何人も集めて、みんなで予測する」

### 5.2 たとえ話: クイズ大会

#### 1人で予測（普通の方法）

```
太郎くん（1人）: 「来週は150人だと思う！」
実際: 140人
誤差: 10人
```

#### みんなで予測（XGBoost）

```
太郎くん: 「150人だと思う」
花子さん: 「いや、130人じゃない？」
次郎くん: 「私は145人だと思う」

みんなの平均: (150 + 130 + 145) ÷ 3 = 141.6人
実際: 140人
誤差: 1.6人 ← すごい！
```

**ポイント**: 1人よりみんなで考えた方が正確！

### 5.3 XGBoostの秘密: 間違いを学ぶ

#### ステップ1: 最初の予測

```
モデル1: 「来週は100人」
実際: 140人
間違い: -40人（40人少なかった）
```

#### ステップ2: 間違いを学ぶ

```
モデル2: 「モデル1が40人少なかったから、+40する！」
予測: 100 + 40 = 140人
実際: 140人
誤差: 0人！ 完璧！
```

#### 実際はもっと複雑

```
モデル1: 予測100人 → 実際140人（-40人ミス）
モデル2: 「+35人するといいよ」 → 135人（-5人ミス）
モデル3: 「さらに+4人」 → 139人（-1人ミス）
モデル4: 「さらに+1人」 → 140人（完璧！）

最終予測 = 100 + 35 + 4 + 1 = 140人
```

### 5.4 なぜXGBoostが一番強いの？

**実験結果**:

| モデル | 説明 | 正確さ（R²） | たとえ |
|---|---|---|---|
| 線形回帰 | 1人で予測 | 42% | 太郎くん1人 |
| ランダムフォレスト | みんなで予測（同時） | 46% | 10人で同時に予測 |
| **XGBoost** | みんなで予測（順番に間違いを直す） | **51%** | 10人で順番に予測を改善 |

**XGBoostの強み**:

1. **賢い友達がたくさん**（200人！）
2. **間違いを学ぶ**（前の人のミスを次の人が直す）
3. **ズルはしない**（過学習を防ぐ仕組み）
4. **めっちゃ速い**（コンピューターが得意）

---

## 6. TimeSeriesSplitって何？

### 6.1 問題: 未来のデータでテストするとズルになる

#### ダメな例（K-Fold）

**たとえ: テスト勉強**
```
テスト前日に、明日のテストの答えを見て勉強する

→ そりゃ100点取れるよね（でもズル）
```

**データでも同じ**:
```
2023年のデータで学習
2022年のデータでテスト ← 未来のデータで過去を予測？

→ 実際には無理（タイムマシンがない）
```

#### 良い例（TimeSeriesSplit）

**たとえ: テスト勉強**
```
1年生の内容で、2年生のテストを予測
2年生の内容で、3年生のテストを予測
3年生の内容で、4年生のテストを予測

→ これなら現実的！
```

**データでも同じ**:
```
2015-2019年のデータで学習 → 2020年を予測
2015-2020年のデータで学習 → 2021年を予測
2015-2021年のデータで学習 → 2022年を予測

→ ちゃんと過去で未来を予測している ✅
```

### 6.2 図で理解する

#### K-Fold（ダメな方法）

```
全データ: [2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022]

Fold 1:
学習: [2016, 2017, 2018, 2019, 2020, 2021, 2022]
テスト: [2015] ← 未来のデータ（2016-2022）で過去（2015）を予測？おかしい！

Fold 2:
学習: [2015, 2017, 2018, 2019, 2020, 2021, 2022]
テスト: [2016] ← 未来のデータ（2017-2022）で予測？おかしい！
```

#### TimeSeriesSplit（良い方法）

```
全データ: [2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022]

Fold 1:
学習: [2015, 2016]
テスト: [2017] ← 過去のデータ（2015-2016）で未来（2017）を予測 ✅

Fold 2:
学習: [2015, 2016, 2017]
テスト: [2018] ← 過去のデータで未来を予測 ✅

Fold 3:
学習: [2015, 2016, 2017, 2018]
テスト: [2019] ← 過去のデータで未来を予測 ✅
```

**ポイント**: 常に「過去で未来を予測」する！

---

## 7. Phase Bの失敗：循環参照問題

### 7.1 何をしようとしたの？

**質問**: 「もしCOVID-19対策がなかったら、インフルエンザは減らなかった？」

**たとえ**:
```
「もし毎日勉強しなかったら、テストで何点取ってた？」
```

### 7.2 なぜ失敗したの？

#### 問題: にわとりが先か、卵が先か

**普通の予測**:
```
先週100人 → 今週を予測 → 120人
```

**反事実的予測（対策がなかった場合）**:
```
2020年第1週: 先週のデータ（2019年第52週）= 80人 → 予測100人
2020年第2週: 先週のデータ（2020年第1週）= ？？？

問題: 2020年第1週は「対策がなかった場合の値（100人）」を使う？
      それとも「実際の値（10人）」を使う？
```

#### たとえ話: 「もし勉強しなかったら？」

```
実際の成績:
1学期: 毎日1時間勉強 → テスト80点
2学期: 毎日2時間勉強 → テスト90点
3学期: 毎日3時間勉強 → テスト95点

「もし勉強しなかったら？」を予測:
1学期: 0時間勉強 → 予測50点
2学期: 0時間勉強 → 予測？点

問題: 2学期の予測には「1学期の成績」が必要
      でも「1学期に勉強しなかった場合の成績（50点）」は予測値
      予測値を使って予測すると、誤差がどんどん大きくなる...
```

### 7.3 結果: 予測が爆発

```
2020年第1週: 予測120人, 実際10人 → 誤差110人
2020年第2週: 予測180人, 実際5人  → 誤差175人
2020年第3週: 予測350人, 実際3人  → 誤差347人
2020年第10週: 予測5000人, 実際2人 → 誤差4998人（爆発！）
```

**結論**: この方法は使えない ❌

### 7.4 この失敗から学んだこと

**教訓**: 「先週のデータ」に頼ると、反事実的予測はできない

**新しいアイデア**:
- 先週のデータを使わない
- 代わりに「恐怖」や「行動」を測る
- → Phase C-Eへ続く！

---

## 8. Phase C-D: Google検索で恐怖を測る

### 8.1 Phase C: COVID-19で何人亡くなった？

**仮説**: 「死亡者数が多い → みんな怖がる → インフルエンザも減る？」

**結果**: R² = 2.4%（ほとんど関係ない）

**たとえ**:
```
「テストで赤点を取った人が10人いた → みんな勉強する？」
→ あまり関係ない（2.4%だけ関係ある）
```

**学び**: 「実際の死亡者数」より「みんなが感じる恐怖」が大事かも？

### 8.2 Phase D: Google検索で「恐怖」を測る

#### アイデア: 検索は恐怖の証拠

**普通の日**:
```
「コロナ 死亡」の検索: 10回
→ あまり怖がってない
```

**怖い日**:
```
「コロナ 死亡」の検索: 1000回
→ みんな超怖がってる！
```

#### 恐怖指数の作り方

**5つのキーワードの検索数**:

| キーワード | 重み | 理由 |
|---|---|---|
| 「コロナ 死亡」 | 2.0 | 一番怖い |
| 「コロナ 重症」 | 2.0 | とても怖い |
| 「医療崩壊」 | 1.5 | 病院に行けない恐怖 |
| 「緊急事態宣言」 | 1.0 | 怖いから出される |
| 「外出自粛」 | 1.0 | 怖いから控える |

**恐怖指数の計算**:
```
恐怖指数 = (「コロナ 死亡」×2 + 「コロナ 重症」×2 + 「医療崩壊」×1.5 + ...) ÷ 7.5
```

#### 結果: Phase Cの2倍！

**Phase C（死亡者数）**: R² = 2.4%
**Phase D（恐怖指数）**: R² = 5.7%（2.4倍！）

**たとえ**:
```
Phase C: 「実際に赤点を取った人の数」→ あまり影響ない
Phase D: 「みんながどれだけ『赤点怖い』と思ってるか」→ 影響が2倍！
```

**学び**: 人は「実際の危険」より「感じる恐怖」で行動する

---

## 9. 媒介分析って何？

### 9.1 かんたんに言うと

**質問**: 「AがBに影響する時、その間に何があるの？」

**たとえ1: 雨と傘**
```
雨 → 濡れたくない → 傘をさす

直接効果: 雨 → 傘をさす（濡れるから）
媒介変数: 「濡れたくない」という気持ち
```

**たとえ2: 勉強と成績**
```
勉強 → 知識が増える → テストの点数が上がる

直接効果: 勉強 → 点数（？）
媒介変数: 「知識」
```

### 9.2 この研究の場合

**質問**: 「恐怖がどうやってインフルエンザを減らすの？」

```
恐怖 → ？？？ → インフルエンザ減少
      ↑
    この「？？？」が知りたい！
```

**仮説**: 「会食」が鍵では？

```
恐怖 → 会食を控える → 人と会わない → インフルエンザ減少
```

### 9.3 媒介分析の3つの経路

#### 図で理解する

```
        会食を控える（M）
          ↗  経路a  ↘  経路b
       /              \
恐怖(X) ─── 直接効果c' ───→ インフルエンザ(Y)
```

#### 経路の説明

**経路a**: 恐怖 → 会食を控える
```
「コロナ怖い」→「居酒屋行くのやめよう」
```

**経路b**: 会食を控える → インフルエンザ減少
```
「居酒屋行かない」→「人と会わない」→「インフルエンザうつらない」
```

**直接効果c'**: 恐怖 → インフルエンザ（会食以外の経路）
```
「コロナ怖い」→「ストレスで免疫力下がる？」（仮説）
```

**間接効果（a × b）**: 恐怖 → 会食 → インフルエンザ
```
「コロナ怖い」→「会食控える」→「インフルエンザ減る」
```

### 9.4 たとえ話: なぜテストの点数が上がった？

**質問**: 「なぜ太郎くんはテストの点数が上がったの？」

#### 仮説1: 直接効果のみ

```
勉強時間が増えた → テストの点数が上がった

でも、なぜ？（説明不足）
```

#### 仮説2: 媒介あり（詳しい説明）

```
勉強時間が増えた（X）
  ↓
知識が増えた（M）← 経路a
  ↓
テストの点数が上がった（Y）← 経路b

経路a: 勉強 → 知識
経路b: 知識 → 点数
間接効果: 勉強 → 知識 → 点数（これが本当の理由！）
```

---

## 10. なぜ会食が重要なの？

### 10.1 会食が一番危険な理由

#### 理由1: マスクを外す

**会食**:
```
「いただきます」→ マスク外す → 食べる・飲む・しゃべる
→ ウイルスが飛びまくる！
```

**通勤・買い物**:
```
ずっとマスク着用 → ウイルスブロック ✅
```

#### 理由2: 長時間・近距離・大声

**会食（居酒屋）**:
```
時間: 1-2時間（長い！）
距離: テーブルで向かい合う（1-2m、近い！）
声: 「乾杯！」「うまい！」（大声！）
→ ウイルス排出量が通常の10-100倍
```

**通勤（電車）**:
```
時間: 30分（短い）
距離: 隣の人と1m（まあまあ）
声: しゃべらない（静か）
→ リスクは低い
```

#### 理由3: 実際のデータで証明

**厚生労働省の調査（2020年）**:

| 場所 | クラスター発生率 |
|---|---|
| **会食・宴会** | **31%**（最多！） |
| オフィス | 15% |
| 医療機関 | 12% |
| 学校 | 10% |
| その他 | 32% |

**結論**: 会食が最大の感染リスク！

### 10.2 会食指数の作り方

**5つのキーワードの検索数**:

| キーワード | 重み | 理由 |
|---|---|---|
| 「居酒屋」 | 3.0 | 一番直接的 |
| 「飲み会」 | 2.5 | 居酒屋に近い |
| 「忘年会」 | 1.5 | 冬だけ（12月） |
| 「新年会」 | 1.5 | 冬だけ（1月） |
| 「歓送迎会」 | 1.0 | 春だけ（3-4月） |

**会食指数の計算**:
```
会食指数 = (「居酒屋」×3 + 「飲み会」×2.5 + ...) ÷ 9.5
```

**検索が多い = みんな会食してる**
**検索が少ない = みんな会食を控えてる**

---

## 11. 完全媒介って何？

### 11.1 媒介の2種類

#### (1) 部分媒介（一部は直接、一部は間接）

**たとえ: 雨と濡れる**

```
雨が降る（X）
  ↓
  ├─ 傘をささない人もいる（M）─→ 濡れる（Y）← 間接効果
  │
  └─ 雨が横から降る ─────────→ 濡れる（Y）← 直接効果

結果: 両方の経路で濡れる
```

#### (2) 完全媒介（すべて間接、直接はゼロ）

**たとえ: リモコンとテレビ**

```
ボタンを押す（X）
  ↓
  ├─ 赤外線が出る（M）─→ テレビがつく（Y）← 間接効果のみ
  │
  └─ ボタン → テレビ ─────────→（直接効果はない）

結果: 赤外線を通じてのみ影響する
```

### 11.2 この研究の結果: 完全媒介！

**発見**:

```
恐怖（X）
  ↓
  ├─ 会食を控える（M）─→ インフルエンザ減少（Y）
  │                        ↑
  │                    間接効果: -0.251（超有意！）
  │
  └─ 直接効果 ───────────→ インフルエンザ減少（Y）
                             ↑
                         直接効果: 0.075（有意ではない）
```

**結論**: 恐怖は**会食を通じてのみ**インフルエンザに影響する！

### 11.3 完全媒介の意味

**わかったこと**:

1. **恐怖だけでは減らない**:
   ```
   「コロナ怖い！」と思うだけ → インフルエンザは減らない
   ```

2. **行動（会食を控える）が必要**:
   ```
   「コロナ怖い！」→「会食やめよう」→ インフルエンザ減る ✅
   ```

3. **介入ポイントが明確**:
   ```
   恐怖を煽るだけ → ダメ
   会食対策（パーテーション、換気など）→ 効果的！
   ```

### 11.4 たとえ話: なぜゲームがうまくなった？

#### 部分媒介の例

```
毎日練習する（X）
  ↓
  ├─ スキルが上がる（M）─→ ゲームがうまくなる（Y）← 間接
  │
  └─ 運が良くなる？ ───────→ ゲームがうまくなる（Y）← 直接（迷信）

両方の経路がある（でも運は関係ないよね）
```

#### 完全媒介の例（この研究）

```
毎日練習する（X）
  ↓
  ├─ スキルが上がる（M）─→ ゲームがうまくなる（Y）← 間接のみ
  │
  └─ 直接効果 ────────────→（ない！）

スキルを通じてのみうまくなる（当然！）
```

---

## 12. 数字の意味を理解しよう

### 12.1 R²（アールにじょう）って何？

**正式名称**: 決定係数（けっていけいすう）

**かんたんに言うと**: 「どれだけ説明できたか？」のパーセント

#### たとえ: テストの点数

**質問**: 「勉強時間で点数を予測できる？」

**データ**:
```
太郎くん: 3時間勉強 → 90点
花子さん: 1時間勉強 → 70点
次郎くん: 2時間勉強 → 80点
```

**R² = 80%の場合**:
```
「勉強時間で、点数の変動の80%を説明できる」

100点満点のテスト:
- 80点分は勉強時間で説明できる
- 20点分は他の理由（才能、運、体調など）
```

**R² = 20%の場合**:
```
「勉強時間で、点数の変動の20%しか説明できない」

100点満点のテスト:
- 20点分だけ勉強時間で説明できる
- 80点分は他の理由（才能、運、体調など）
```

#### この研究の結果

**Phase D（恐怖指数）**:
```
R² = 5.7%
→ 恐怖指数で、インフルエンザの変動の5.7%を説明
→ 94.3%は他の理由（季節、マスク、手洗いなど）
```

**Phase D拡張版（会食指数）**:
```
経路a（恐怖 → 会食）: R² = 44.9%
→ 恐怖指数で、会食の変動の44.9%を説明 ← 大成功！
→ 55.1%は他の理由（給料日、イベントなど）
```

### 12.2 p値（ピーち）って何？

**正式名称**: 有意確率（ゆういかくりつ）

**かんたんに言うと**: 「偶然じゃない確率」

#### たとえ: コイン投げ

**実験**: コインを10回投げる

**結果1: 表6回、裏4回**
```
p = 0.377（37.7%の確率で偶然起こる）
→ 普通（偶然かも）
```

**結果2: 表10回、裏0回**
```
p = 0.001（0.1%の確率でしか起こらない）
→ おかしい！（このコイン怪しい！）
```

#### この研究の結果

**基準**: p < 0.05（5%未満）なら「偶然じゃない」

**Phase D拡張版**:
```
経路a（恐怖 → 会食）: p < 0.0001（0.01%未満）
→ ほぼ確実に関係ある！

直接効果c'（恐怖 → インフル）: p = 0.183（18.3%）
→ p > 0.05だから「関係ない」
```

### 12.3 係数（けいすう）って何？

**かんたんに言うと**: 「1増えたら、どれだけ変わる？」

#### たとえ: 身長と体重

**係数 = 0.5の場合**:
```
身長が1cm増える → 体重が0.5kg増える

例:
太郎くん: 150cm → 50kg
花子さん: 160cm → 55kg（+10cm → +5kg）
```

#### この研究の結果

**経路a（恐怖 → 会食）**:
```
係数 = -0.335（マイナス！）

恐怖指数が1増える → 会食指数が0.335減る

例:
平常時: 恐怖50 → 会食100
緊急事態宣言: 恐怖80（+30） → 会食90（-10）
```

**経路b（会食 → インフル）**:
```
係数 = 0.750（プラス！）

会食指数が1増える → インフルエンザが0.75人増える

例:
会食少ない時: 会食50 → インフル5人
会食多い時: 会食100（+50） → インフル42.5人（+37.5人）
```

---

## 13. Phase A-Eのストーリー

### Phase A: 予測モデルを作ろう！

**目標**: 来週のインフルエンザ患者数を予測

**方法**:
- 先週のデータ
- 気温・湿度
- 何月か

**結果**: R² = 51%（まあまあ成功！）

**たとえ**: 「先週5人風邪 → 今週も5人くらいかな」

---

### Phase B: 「もしも」を予測しよう → **失敗**

**目標**: もしCOVID-19対策がなかったら、インフルエンザは減らなかった？

**方法**: 2019年までのデータで2020年以降を予測

**結果**: 失敗（誤差が爆発）

**問題**: 「先週のデータ」が循環参照

**たとえ**: 「明日のテストの答えを見て今日勉強する」みたいな矛盾

**学び**: 「先週のデータ」を使わない方法が必要

---

### Phase C: COVID-19の死亡者数 → **いまいち**

**目標**: 死亡者数でインフルエンザを説明

**方法**: 死亡者数 → インフルエンザ

**結果**: R² = 2.4%（ほとんど関係ない）

**たとえ**: 「実際に赤点を取った人の数 → みんなの勉強時間」（あまり関係ない）

**学び**: 「実際の危険」より「感じる恐怖」が大事かも

---

### Phase D: Google検索で恐怖を測る → **改善**

**目標**: みんなが感じる恐怖を測る

**方法**: 「コロナ 死亡」などの検索数 → インフルエンザ

**結果**: R² = 5.7%（Phase Cの2.4倍！）

**たとえ**: 「『赤点怖い』とググる人の数 → 勉強時間」（関係ある！）

**学び**: 恐怖は測れた！でも、まだ94.3%が説明できない...

---

### Phase E: 隣の人指数 → **失敗**

**目標**: 「みんながやってるから自分も」の同調圧力を測る

**方法**: 「みんな マスク」などの検索数 → インフルエンザ

**結果**: R² = 1.2%（最低...）

**たとえ**: 「みんな勉強してる → 自分も勉強する」（あまり関係ない）

**学び**: 行動そのものより、動機（恐怖）が大事

---

### Phase D拡張版: 媒介分析 → **大成功！**

**目標**: 恐怖がどうやってインフルエンザを減らすのか？

**仮説**: 恐怖 → 会食を控える → インフルエンザ減少

**方法**: 媒介分析

**結果**:
- 経路a（恐怖 → 会食）: **R² = 44.9%**（Phase Dの8倍！）
- 経路b（会食 → インフル）: R² = 18.9%
- 直接効果: 非有意（関係ない）
- **完全媒介！**

**たとえ**: 「『赤点怖い』→ 勉強時間増える → テストの点数上がる」

**学び**: 恐怖は会食を通じてのみインフルエンザに影響する！

---

## 14. この研究の凄いところ

### 凄いところ1: 失敗から学んだ

```
Phase B: 失敗 → 「先週のデータはダメだ」
Phase C: いまいち → 「実際の危険より恐怖が大事」
Phase E: 失敗 → 「行動より動機が大事」

→ 失敗を重ねて Phase D拡張版で大成功！
```

**たとえ**: エジソンの「失敗ではない。うまくいかない方法を発見しただけだ」

### 凄いところ2: R²が8倍に改善

```
Phase D: R² = 5.7%
Phase D拡張版: R² = 44.9%（8倍！）
```

**たとえ**: テストの点数が50点から400点になったようなもの（すごい！）

### 凄いところ3: 因果メカニズムを解明

**Phase Dまで**:
```
恐怖 → インフルエンザ（なぜかはわからない）
```

**Phase D拡張版**:
```
恐怖 → 会食を控える → インフルエンザ減少（メカニズムが明確！）
```

**たとえ**: 「勉強すると点数が上がる」→「勉強すると知識が増えて点数が上がる」

### 凄いところ4: 実用的な示唆

**わかったこと**:
1. 恐怖を煽るだけではダメ
2. 会食対策が重要（パーテーション、換気、時短営業）
3. 会食指数でインフルエンザが予測できる

**たとえ**: 「勉強しろ！」と言うだけではダメ、「知識を増やす方法」を教える

---

## 15. 用語集（五十音順）

### あ行

**R²（アールにじょう）**:
- 正式名称: 決定係数
- 意味: どれだけ説明できたか（0-100%）
- 例: R²=50% → 半分説明できた

**移動平均（いどうへいきん）**:
- 意味: 直近のデータの平均
- 例: 過去4週間の平均患者数
- 目的: ノイズを除去

**XGBoost（エックスジーブースト）**:
- 意味: めっちゃ賢い予測モデル
- 特徴: 間違いを学んで改善する
- 例: 200人の賢い友達が協力

**OLS回帰（オーエルエスかいき）**:
- 正式名称: 最小二乗法
- 意味: 一番シンプルな予測方法
- 特徴: 直線で予測

### か行

**外れ値（はずれち）**:
- 意味: 他と大きく違う値
- 例: クラスのみんな150cm、太郎くんだけ200cm
- 問題: 予測を狂わせる

**完全媒介（かんぜんばいかい）**:
- 意味: すべて間接効果
- 例: リモコン → 赤外線 → テレビ（赤外線を通じてのみ）
- 対義語: 部分媒介

**季節性（きせつせい）**:
- 意味: 毎年同じパターン
- 例: 冬にインフルエンザ増える
- 英語: Seasonality

**偽の有意性（ぎのゆういせい）**:
- 意味: 本当は関係ないのに関係あるように見える
- 原因: データリーク、多重比較など
- 例: 未来のデータでテスト

**共線性（きょうせんせい）**:
- 意味: 2つの変数が強く相関
- 問題: どちらが原因かわからない
- 例: 気温と湿度（両方とも夏に高い）

**交絡因子（こうらくいんし）**:
- 意味: 両方に影響する第三の変数
- 例: 夏 → アイス売上↑、夏 → 溺死者数↑
- 結果: 見せかけの相関

**勾配ブースティング（こうばいぶーすてぃんぐ）**:
- 意味: 間違いを学んで改善する方法
- 例: モデル1の誤差をモデル2が修正
- 代表例: XGBoost

### さ行

**自己相関（じこそうかん）**:
- 意味: 過去と現在が似ている
- 例: 先週100人 → 今週も100人くらい
- 英語: Autocorrelation

**時系列データ（じけいれつでーた）**:
- 意味: 時間順に並んだデータ
- 例: 毎週の患者数
- 特徴: 順序が大事

**従属変数（じゅうぞくへんすう）**:
- 意味: 予測したい値
- 例: テストの点数、インフルエンザ患者数
- 記号: Y
- 別名: 目的変数

**循環参照（じゅんかんさんしょう）**:
- 意味: AがBを参照、BがAを参照
- 問題: 無限ループ
- 例: 「先週のデータが必要 → 先週も先週のデータが必要 → ...」

**p値（ピーち）**:
- 正式名称: 有意確率
- 意味: 偶然じゃない確率
- 基準: p<0.05なら「偶然じゃない」

**相関係数（そうかんけいすう）**:
- 意味: どれだけ似ているか（-1～+1）
- 記号: r
- 例: r=0.9（めっちゃ似てる）、r=0（全然似てない）

### た行

**多重共線性（たじゅうきょうせんせい）**:
- 意味: 複数の説明変数が強く相関
- 問題: どの変数が重要かわからない
- 検出: VIF（バリアンス・インフレーション・ファクター）

**TimeSeriesSplit（タイムシリーズスプリット）**:
- 意味: 時系列データ用の検証方法
- 特徴: 必ず過去で未来を予測
- 対義語: K-Fold（普通のデータ用）

**データリーク（データりーく）**:
- 意味: 未来の情報が漏れる
- 問題: 予測が不当に良くなる
- 例: 明日のテストの答えを見て勉強

**特徴量（とくちょうりょう）**:
- 意味: 予測のヒント
- 例: 気温、先週の患者数、何月か
- 英語: Feature

**独立変数（どくりつへんすう）**:
- 意味: 予測に使う値
- 例: 勉強時間、気温、恐怖指数
- 記号: X
- 別名: 説明変数

**トレンド**:
- 意味: 長期的な増減
- 例: 毎年5cm身長が伸びる
- 英語: Trend

### は行

**ハイパーパラメータ**:
- 意味: モデルの設定値
- 例: XGBoostの木の数（200本）、深さ（5）
- 調整方法: GridSearch、Bayesian Optimization

**媒介変数（ばいかいへんすう）**:
- 意味: XとYをつなぐ変数
- 例: 勉強 → 知識 → 点数（知識が媒介変数）
- 記号: M
- 英語: Mediator

**標準誤差（ひょうじゅんごさ）**:
- 意味: 予測のバラつき
- 小さい → 安定した予測
- 大きい → ブレる予測

**部分媒介（ぶぶんばいかい）**:
- 意味: 直接効果と間接効果の両方
- 例: 雨 → 濡れる（直接）、雨 → 傘 → 濡れる（間接）
- 対義語: 完全媒介

### ま行

**見せかけの相関（みせかけのそうかん）**:
- 意味: 本当は関係ないのに相関
- 原因: 交絡因子
- 例: アイス売上と溺死者数（夏が原因）

### ら行

**ラグ特徴量（ラグとくちょうりょう）**:
- 意味: 過去のデータ
- 例: 1週前の患者数、去年の同じ週
- 英語: Lag Feature
- 問題: 循環参照のリスク

**ランダムフォレスト**:
- 意味: たくさんの決定木の平均
- 特徴: 過学習しにくい
- 例: 100人で同時に予測して平均

**リーク**（→データリーク）

**レート制限（れーとせいげん）**:
- 意味: 1日に使える回数制限
- 例: Google Trends APIは1日100回まで
- 英語: Rate Limit

### わ行

**ワイルドカード検索（わいるどかーどけんさく）**:
- 意味: あいまい検索
- 例: 「インフル*」→「インフルエンザ」「インフル」両方ヒット

---

## 16. 最後に

### この研究の一番大事なメッセージ

**「失敗は成功の母」**

```
Phase B: 失敗
Phase C: いまいち
Phase E: 失敗

でも...

Phase D拡張版: 大成功！（R²が8倍に改善）
```

**失敗から学んで、最後に大きな発見につながった**

### 小学生のみんなへ

**データサイエンスって何？**:
- 過去のデータから未来を予測する
- 「なぜ？」を数字で説明する

**大事なこと**:
1. **好奇心**: 「なぜ？」と疑問を持つ
2. **失敗を恐れない**: 失敗から学ぶ
3. **粘り強さ**: Phase Eまで諦めなかった

**たとえ**:
- 野球: 何度も素振りして上手くなる
- 勉強: わからない問題を何度も解く
- データサイエンス: 何度も試して良い方法を見つける

### 保護者・教育者の方へ

この解説は、以下の教育目標を意識して作成しました:

1. **抽象概念の具体化**: 統計用語を日常の例で説明
2. **段階的理解**: 簡単な例から複雑な概念へ
3. **視覚的理解**: 図・表・数式をできるだけ避け、言葉で説明
4. **動機づけ**: 「失敗から学ぶ」ストーリー

もし質問があれば、いつでも聞いてください！

---

## 17. 今後の研究：もっと良い社会を作るために

### 17.1 この研究でわかったこと（おさらい）

**大発見**:
```
恐怖 → 会食を控える → インフルエンザ減少

恐怖（パンデミック）がないと、人は行動を変えない？
```

**新しい疑問**:
```
「恐怖」がなくても、自分から良い行動ができないかな？
```

### 17.2 次の研究テーマ1: 自発的な行動変容のヒント探し

#### 問題: 恐怖に頼りすぎ？

**今回の研究**:
```
COVID-19の恐怖 → 会食を控える → インフルエンザ減少
```

**でも、これって...**:
- 恐怖がなくなったら、また会食が増える？
- 恐怖だけで行動を変えるのは良くない？
- もっと良い方法はないの？

#### 新しい研究: 恐怖以外のヒント探し

**探したいヒント（ファクター）**:

**1. ポジティブな動機（良いこと）**
```
恐怖: 「コロナ怖い！会食やめよう」← ネガティブ
ポジティブ: 「健康でいたい！会食を控えよう」← ポジティブ

たとえ:
「宿題やらないと怒られる」← 恐怖
「宿題やると力がつく！」← ポジティブ
```

**測り方**:
- Google検索: 「健康 メリット」「免疫力 アップ」
- SNSの投稿: ポジティブな健康情報の拡散数

**2. 社会規範（みんながやってる）**
```
「周りのみんなが手洗いしてる → 自分もやろう」

たとえ:
「クラスのみんなが勉強してる → 自分もやろう」
```

**測り方**:
- Google検索: 「手洗い 習慣」「マスク 定着」
- 公共の場での観察データ

**3. 経済的インセンティブ（得するから）**
```
「会食を控えると医療費が減る → お金が浮く」

たとえ:
「早寝すると成績上がる → お小遣いもらえる」
```

**測り方**:
- 医療費削減額の情報発信
- ポイント還元キャンペーン

**4. 知識・教育**
```
「インフルエンザの感染経路を知る → 会食のリスクを理解 → 控える」

たとえ:
「なぜ勉強が大事か理解する → 自分から勉強する」
```

**測り方**:
- Google検索: 「インフルエンザ 感染経路」「飛沫感染 仕組み」
- 教育プログラムの効果測定

#### 研究方法

**Phase F（仮）: ポジティブ動機指数**
```
キーワード:
- 「健康 メリット」
- 「免疫力 アップ」
- 「予防 効果」

仮説: ポジティブ動機 → 手洗い・マスク → インフルエンザ減少
```

**Phase G（仮）: 社会規範指数**
```
キーワード:
- 「みんな マスク」
- 「手洗い 習慣化」
- 「新しい生活様式 定着」

仮説: 社会規範 → 自発的な予防行動 → インフルエンザ減少
```

### 17.3 次の研究テーマ2: 数理モデルの設計

#### 数理モデルって何？

**かんたんに言うと**: 数式で未来を予測する

**たとえ**:
```
身長の予測モデル:
今年の身長 = 去年の身長 + 5cm

インフルエンザの予測モデル（もっと複雑）:
今週の患者数 = f(恐怖指数, 会食指数, 気温, ...)
```

#### この研究を数理モデルに生かす

**従来のモデル（SIRモデル）**:
```
S（健康な人）→ I（感染した人）→ R（回復した人）

問題: 人の行動（会食）を考慮していない
```

**新しいモデル（SIR + 行動モデル）**:
```
S（健康な人）→ I（感染した人）→ R（回復した人）
      ↑
    会食行動（減ると感染しにくい）
      ↑
   恐怖指数（増えると会食が減る）
```

**数式（イメージ）**:
```
会食指数(t) = 100 - 0.335 × 恐怖指数(t)
感染率(t) = 基本感染率 × 会食指数(t) / 100
患者数(t+1) = 患者数(t) × 感染率(t)
```

**メリット**:
1. **より正確な予測**: 人の行動を考慮
2. **政策シミュレーション**: 「会食を50%減らすと患者数はどうなる？」
3. **早期警戒システム**: Google Trendsでリアルタイム予測

#### 応用例: 薬局の在庫管理

**現状の問題**:
```
冬になると急に患者が増える
  ↓
咳止め薬が足りない！
  ↓
緊急発注（でも間に合わない）
```

**新しいシステム（この研究の応用）**:
```
Google Trendsで会食指数をチェック
  ↓
会食指数が増えてる！
  ↓
2週間後にインフルエンザ増えそう
  ↓
今のうちに咳止め薬を発注 ✅
```

**たとえ**:
```
天気予報を見て傘を準備する
→ 雨に濡れない ✅

会食指数を見て薬を準備する
→ 薬不足にならない ✅
```

### 17.4 次の研究テーマ3: パンデミック以外への応用

#### 応用1: 季節性インフルエンザ

**これまで（パンデミック時）**:
```
恐怖 → 会食を控える → インフルエンザ減少
```

**普通の冬（パンデミックなし）**:
```
恐怖はない...
じゃあ、何が会食を減らす？

候補:
- 年末年始の忙しさ？
- 給料日前で金欠？
- 健康意識の高まり？
```

**研究方法**:
```
Phase H（仮）: 普通の冬の会食変動要因

データ:
- Google検索: 「忙しい 年末」「給料日」
- 経済指標: 可処分所得
- 健康意識: 「インフルエンザ 予防」検索

仮説: 経済的要因 → 会食減少 → インフルエンザ減少？
```

#### 応用2: 他の感染症

**RSウイルス（子どもの風邪）**:
```
仮説: 保育園の出席率 → 接触機会 → RSウイルス

データ:
- 保育園の出席率
- Google検索: 「保育園 休ませる」
```

**ノロウイルス（冬の食中毒）**:
```
仮説: 外食頻度 → 感染リスク → ノロウイルス

データ:
- Google検索: 「外食」「レストラン」
- クレジットカード決済データ（外食費）
```

#### 応用3: 生活習慣病

**糖尿病**:
```
仮説: 健康意識 → 食生活改善 → 血糖値低下

データ:
- Google検索: 「糖質制限」「血糖値 下げる」
- 食品購入データ（野菜、肉、菓子）
```

**うつ病**:
```
仮説: ストレス → 運動減少 → うつ症状悪化

データ:
- Google検索: 「ストレス 発散」「運動 効果」
- スマホの歩数計データ
```

### 17.5 社会をより良くするために

#### ゴール1: 自発的な予防行動の促進

**現状**:
```
パンデミック → 恐怖 → 行動変容
（恐怖がないと動かない）
```

**理想**:
```
知識・教育 → 理解 → 自発的な予防行動
（恐怖がなくても動く）
```

**たとえ**:
```
現状: 「テストで赤点取りたくない！」← 恐怖
理想: 「知識を得るのって楽しい！」← 自発的
```

#### ゴール2: データドリブンな公衆衛生

**Data-Driven Public Health（データに基づく健康政策）**:

**従来**:
```
患者が増えてから対策
  ↓
遅い...
```

**新しいアプローチ**:
```
Google Trendsで予兆を検出
  ↓
患者が増える前に対策 ✅
```

**たとえ**:
```
従来: 虫歯になってから歯医者
新しい: 歯が痛くなる前に定期検診 ✅
```

#### ゴール3: 個人の力で社会を変える

**この研究の示唆**:
```
1人1人の行動（会食を控える）
  ↓
みんなが少しずつ変わる
  ↓
社会全体で大きな変化（インフルエンザ90%減）
```

**たとえ**:
```
1人1人がゴミを拾う
  ↓
街がきれいになる

1人1人がエコバッグを使う
  ↓
プラスチックゴミが減る
```

### 17.6 次の10年で実現したいこと

#### 2025-2030年: 研究フェーズ

**やること**:
1. Phase F-H: 自発的行動変容のファクター探索
2. 数理モデルの構築（SIR + 行動モデル）
3. 他の感染症・疾患への応用

#### 2030-2035年: 実用化フェーズ

**やること**:
1. **予測システムの構築**:
   - Google Trendsでリアルタイム予測
   - 薬局・病院への情報提供

2. **教育プログラムの開発**:
   - 小学生向け: 感染症の仕組み
   - 大人向け: 予防行動のメリット

3. **政策への提言**:
   - データに基づく感染症対策
   - 行動変容を促す施策

#### 未来の社会

**理想の姿**:
```
みんなが感染症のリスクを理解
  ↓
自分から予防行動（手洗い、マスク、会食時の注意）
  ↓
インフルエンザの大流行がなくなる
  ↓
薬が不足しない、病院が混雑しない ✅
```

**たとえ**:
```
みんなが交通ルールを守る
  ↓
事故が減る
  ↓
安全な社会 ✅
```

---

## 18. まとめ：この研究が示す未来

### わかったこと

1. **恐怖は会食を減らす**（R² = 44.9%）
2. **会食を減らすとインフルエンザが減る**
3. **恐怖は会食を通じてのみ影響する**（完全媒介）

### これからやること

1. **恐怖以外のファクター探し**
   - ポジティブな動機
   - 社会規範
   - 経済的インセンティブ

2. **数理モデルの設計**
   - 人の行動を考慮したモデル
   - リアルタイム予測システム

3. **他の病気への応用**
   - RSウイルス、ノロウイルス
   - 糖尿病、うつ病

### 最終目標

**「自分から、みんなで、健康な社会を作る」**

**たとえ**:
```
みんなが自分から勉強する
  ↓
クラス全体の成績が上がる
  ↓
楽しい学校生活 ✅

みんなが自分から予防する
  ↓
社会全体で病気が減る
  ↓
健康で幸せな社会 ✅
```

**この研究は、そのための第一歩です！**

---

**作成日**: 2025年12月14日
**バージョン**: 1.1（小学生版・今後の研究追加）
**対象**: 小学校高学年～中学生、統計学初学者
